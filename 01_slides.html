<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Procesamiento de Lenguaje Natural con R   ¬†  ¬†   </title>
    <meta charset="utf-8" />
    <meta name="author" content="V√≠ctor Sanz, PhD   ¬†victor.sanz@ugr.es  ¬† @vsslledo ¬† VictorSuarezL" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="title_slide.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Procesamiento de Lenguaje Natural con R<br> <i class="fas fa-globe"></i> ¬† <i class="fas fa-laptop"></i> ¬† <i class="fas fa-chart-line"></i> <br>
]
.subtitle[
## F0TH
]
.author[
### V√≠ctor Sanz, PhD <br><br><a href="mailto:victor.sanz@ugr.es"><i class="fa fa-paper-plane fa-fw"></i>¬†victor.sanz@ugr.es</a><br><a href="https://twitter.com/vsslledo"> <i class="fab fa-twitter"></i>¬† <span class="citation">@vsslledo</span></a><br><a href="https://github.com/VictorSuarezL"><i class="fab fa-github"></i>¬† VictorSuarezL</a>
]

---







# &lt;i class="fas fa-indent"&gt;&lt;/i&gt; √çndice:
.pull-left[
### Mi√©rcones 5 de feb

1. Repaso Tidyverse:
  1. El universo tidyverse
  1. Principales operaciones en tidyverse/dplyr

1. Obtenci√≥n de datos:
  1. API's
  1. Web Scraping

1. Las caracter√≠sticas del lenguaje natural:
  1. Expresiones Regulares
  1. Bag of Words
]
--

.pull-right[
### Jueves 6 de feb

1. Exploraci√≥n de datos textuales
1. Clasificaci√≥n de tem√°ticas 
1. An√°lisis de datos
1. An√°lisis basado en redes
]


---

# &lt;i class="fab fa-twitter"&gt;&lt;/i&gt; API de Redes Sociales  

**API**: Application Programming Interface.

&lt;u&gt;Existen dos m√©todos para acceder a los datos usando APIs:&lt;/u&gt;

--

1. **Stream API**:

  - Proporciona un flujo de mensajes en tiempo real pueden filtarse por una serie de caracter√≠sticas, siendo las m√°s habituales: palabras clave, usuarios y localizaciones.
  - Tambi√©n puede obtenerse una muestra aleatoria (~1%).
  - Limitaciones: S√≥lo en tiempo real.

--

1. **REST API**: 

  - Proporciona informaci√≥n sobre el perfil de usuarios, timeline, lista de usuarios y seguidores, etc.
  - Limitaciones: suele tener limitaciones de cantidad de mensajes o limitaciones temporales. 
  
-&gt; Ojo! Twitter ha sido probablemente una de las APIs m√°s populares a la hora de analizar redes sociales. Debido a las nuevas pol√≠ticas la mayor√≠a de sus funcionalidades son de pago, sin embargo existen otras plataformas como Mastodon, Reddit, etc... con APIs para probar
  
---

## Variables obtenidas

- **user_id:** ID del usuario.
- **status_id:** ID del status o tweet.
- **created_at:** Fecha de creaci√≥n del tweet.
- **screenName:** Nombre de pantalla del usuario.
- **text:** Texto dentro del status o tweet.
- **source:** Clase de dispositivo.
- **reply_to_status_id:** ID del status al que responde.
- **reply_to_user_id:** ID del usuario al que responde.
- **reply_to_screen_name:** Nombre de pantalla al que responde.
- **is_retweet:** TRUE si el status o tweet ha sido retwuiteado.
- **favorite_count:** N√∫mero de veces el status o tweet ha sido marcado como favorito.
- **retweet_count:** N√∫mero de veces el status o tweet ha sido retwuiteado.

---
layout: false
class: inverse, center, middle

# &lt;i class="fas fa-bullhorn"&gt;&lt;/i&gt; Stream API 

---
layout: true

# &lt;i class="fas fa-bullhorn"&gt;&lt;/i&gt; Caracter√≠sticas Stream API

---

Documentaci√≥n: [link](https://developer.twitter.com/en/docs/tweets/filter-realtime/guides/connecting.html).

--

### Es la manera m√°s recomendada para extraer la informaci√≥n: 
  - 400 palabras clave
  
  - 5,000 id de usuarios 
  
  - 25 location boxes&lt;sup&gt;1&lt;/sup&gt;

--

### Problemas:

  - Puede desconectarse con facilidad
  
  - Es recomendable guardar la informaci√≥n obtenida con regularidad
  
  - Programar script para reiniciarse cada hora

.foot-note[
[Location Boxes](https://boundingbox.klokantech.com/)
]

---
layout: false
class: inverse, center, middle

# &lt;i class="fas fa-undo-alt"&gt;&lt;/i&gt; Rest API 

---

# &lt;i class="fas fa-undo-alt"&gt;&lt;/i&gt; Caracter√≠sticas Rest API

Documentaci√≥n: [link](https://developer.twitter.com/en/docs/tweets/post-and-engage/overview)

### Es la manera de obtener mayor tipo de informaci√≥n:
  - Timeline
  
  - Informaci√≥n del usuario
  
  - Lista de friends
  
  - Lista de followers
  
  
### Problemas:
  - Las cantidad de b√∫squeda est√° limitada
  
  - Retroceder en el tiempo es complicado

---
class: center, middle, inverse

# &lt;i class="fab fa-creative-commons-sampling"&gt;&lt;/i&gt; Sampling bias?

---
layout: true

# &lt;i class="fab fa-creative-commons-sampling"&gt;&lt;/i&gt; Sampling bias?

---

- **Morstatter, F., Pfeffer, J., Liu, H., &amp; Carley, K. M.** (2013). Is the Sample Good Enough? Comparing Data from Twitter‚Äôs Streaming API with Twitter‚Äôs Firehose. [Link](http://doi.org/10.1007/978-3-319-05579-4_10) 

- **Gonz√°lez-Bail√≥n, S., Wang, N., Rivero, A., Borge-Holthoefer, J., &amp; Moreno, Y.** (2014). Assessing the bias in samples of large online networks. Social Networks. [Link](http://doi.org/10.1016/j.socnet.2014.01.004)

- **Driscoll, K., &amp; Walker, S.** (2014). Working within a black box: Transparency in the collection and production of big twitter data. International Journal of Communication. [Link]( http://doi.org/10.1016/j.jaci.2003.08.001)

- **Joseph, K., Landwehr, P. M., &amp; Carley, K. M.** (2014). Two 1%s Don‚Äôt make a whole: Comparing simultaneous samples from Twitter‚Äôs Streaming API. En Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics). [Link](http://doi.org/10.1007/978-3-319-05579-4_10)

- **Steinert-Threlkeld**, Z. (2018). Twitter as Data (Elements in Quantitative and Computational Methods for the Social Sciences). Cambridge: Cambridge University Press. doi:10.1017/9781108529327

---

### Consideraciones

- La muestra aleatoria del 1% no es realmente aleatoria.

- Los hashtags, usuarios, topics menos populares son menos probables de entrar en la muestra.

- Para las b√∫squedas realizadas por keyword el sesgo no es tan importante.

- Las muestras peque√±as obtenidas a trav√©s de un conjunto de hashtags pueden estar sesgadas.

- Los datos obtenidos a trav√©s de la REST API est√°n m√°s sesgados que los obtenidos a trav√©s de la Streaming API.

---
layout: false
class: center, middle, inverse

# &lt;i class="fas fa-globe"&gt;&lt;/i&gt; Web Scraping

---

layout: true
# &lt;i class="fas fa-globe"&gt;&lt;/i&gt; Web Scraping

---

### ¬øEn qu√© consiste el web scraping?

- T√©cnica para extraer datos de p√°ginas web.

- Automatiza la recopilaci√≥n de informaci√≥n.

- Utiliza c√≥digo para "leer" el contenido HTML.

- Permite transformar datos no estructurados en estructurados.

---

### ¬øPara qu√© resulta √∫til el web scraping?

- Investigaci√≥n acad√©mica: Recolecci√≥n de grandes vol√∫menes de datos.

- An√°lisis de mercado: Seguimiento de precios, productos, tendencias.

- Periodismo de datos: Extracci√≥n de informaci√≥n de fuentes p√∫blicas.

- Automatizaci√≥n: Actualizaci√≥n de bases de datos de forma autom√°tica.

---

### ¬øC√≥mo funciona el web scraping?

- Enviar petici√≥n HTTP al servidor web (GET).

- Recibir el HTML de la p√°gina.

- Analizar el HTML usando selectores CSS o XPath.

- Extraer los datos deseados.

- Almacenar la informaci√≥n en CSV, JSON, bases de datos, etc.

---

### Consideraciones legales:

- Revisar el archivo robots.txt del sitio web.

- Cumplir con los t√©rminos de servicio de la p√°gina.

- Evitar sobrecargar servidores (buenas pr√°cticas).

- Consideraciones de propiedad intelectual y privacidad.

--- 

### üí° Herramientas populares para Web Scraping

- Python: BeautifulSoup, Scrapy, Selenium.

- R: rvest, httr, xml2.

- Javascript: Puppeteer, Cheerio.

---

### Un ejemplo usando `rvest`

Ejemplo: [link](https://developer.twitter.com/en/docs/tweets/filter-realtime/guides/connecting.html).



``` r
library(rvest)

# URL de la p√°gina web (usa tu propia URL si est√°s trabajando en local)
url &lt;- "https://quotes.toscrape.com/" # Ejemplo de p√°gina similar

# Leer el contenido HTML de la p√°gina
webpage &lt;- read_html(url)

# Extraer las citas utilizando los selectores CSS
quotes &lt;- webpage %&gt;%
  html_nodes(".quote .text") %&gt;% # Selecciona el texto dentro de la clase 'quote'
  html_text() # Extrae el texto puro

# Ver las citas extra√≠das
print(quotes)
```

---

### Un ejemplo usando `rvest`


```
#&gt;  [1] "‚ÄúThe world as we have created it is a process of our thinking. It cannot be changed without changing our thinking.‚Äù"                
#&gt;  [2] "‚ÄúIt is our choices, Harry, that show what we truly are, far more than our abilities.‚Äù"                                              
#&gt;  [3] "‚ÄúThere are only two ways to live your life. One is as though nothing is a miracle. The other is as though everything is a miracle.‚Äù"
#&gt;  [4] "‚ÄúThe person, be it gentleman or lady, who has not pleasure in a good novel, must be intolerably stupid.‚Äù"                           
#&gt;  [5] "‚ÄúImperfection is beauty, madness is genius and it's better to be absolutely ridiculous than absolutely boring.‚Äù"                    
#&gt;  [6] "‚ÄúTry not to become a man of success. Rather become a man of value.‚Äù"                                                                
#&gt;  [7] "‚ÄúIt is better to be hated for what you are than to be loved for what you are not.‚Äù"                                                 
#&gt;  [8] "‚ÄúI have not failed. I've just found 10,000 ways that won't work.‚Äù"                                                                  
#&gt;  [9] "‚ÄúA woman is like a tea bag; you never know how strong it is until it's in hot water.‚Äù"                                              
#&gt; [10] "‚ÄúA day without sunshine is like, you know, night.‚Äù"
```

---

### Un ejemplo usando `rvest`


``` r
webpage &lt;- read_html(url)

# Extraer los nombres de los autores
authors &lt;- webpage %&gt;%
  html_nodes(".author") %&gt;% # Selecciona los elementos con la clase 'author'
  html_text() # Extrae el texto de esos elementos

# Mostrar los autores extra√≠dos
print(authors)
```

---

### Un ejemplo usando `rvest`


```
#&gt;  [1] "Albert Einstein"   "J.K. Rowling"      "Albert Einstein"  
#&gt;  [4] "Jane Austen"       "Marilyn Monroe"    "Albert Einstein"  
#&gt;  [7] "Andr√© Gide"        "Thomas A. Edison"  "Eleanor Roosevelt"
#&gt; [10] "Steve Martin"
```

---

layout: false
class: center, middle, inverse

# &lt;i class="fas fa-guitar"&gt;&lt;/i&gt; Trabajar con cadenas de texto

---

layout: true

# &lt;i class="fas fa-guitar"&gt;&lt;/i&gt; StringR

---

### ¬øPara qu√© sirve?

Documentaci√≥n: [link](https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf)

- Manejo de cadenas de texto de forma sencilla y eficiente.
- Sintaxis clara y consistente con el tidyverse.
- Facilita tareas de limpieza, transformaci√≥n y extracci√≥n de texto.
- Optimizado para trabajar con datos textuales en an√°lisis de datos y miner√≠a de texto.

---

### Funciones m√°s comunes:
- B√∫squeda y detecci√≥n de patrones (`str_detect`, `str_which`)
- Extracci√≥n de texto espec√≠fico (`str_extract`, `str_extract_all`)
- Sustituci√≥n y limpieza de texto (`str_replace`, `str_replace_all`)
- Divisi√≥n y uni√≥n de texto (`str_split`, `str_c`)
- Manipulaci√≥n de longitud y formato (`str_trim`, `str_pad`, `str_to_lower`, `str_to_upper`)

---

### Act. 1:
En el archivo `covid_19.rds` os he dejado una muestra de tweets sobre la conversaci√≥n que tuvo lugar a principios del Covid. ¬øC√≥mo podr√≠amos saber cu√°les son las personas m√°s mencionadas en esos tweets?

### Act. 2:
¬øY cu√°les son los hashtags m√°s usados?

---

### Act. 1:


``` r
library(stringr)

read_rds("./data/covid_19.rds") %&gt;%
  select(screen_name, text, created_at) -&gt; df

df %&gt;%
  filter(str_detect(text, "@")) %&gt;%
  mutate(text = str_extract_all(text, "@\\w+", simplify = F)) %&gt;%
  unnest(text) %&gt;%
  count(text, sort = T)
```

---


```
#&gt; # A tibble: 574 √ó 2
#&gt;    text                 n
#&gt;    &lt;chr&gt;            &lt;int&gt;
#&gt;  1 @realDonaldTrump    57
#&gt;  2 @RealJamesWoods     45
#&gt;  3 @LivePDDave1        31
#&gt;  4 @DonaldJTrumpJr     16
#&gt;  5 @RealCandaceO       15
#&gt;  6 @Heat_Miser2        14
#&gt;  7 @SKYRIDER4538       14
#&gt;  8 @ScottFordTVGuy     12
#&gt;  9 @Julietknows1       11
#&gt; 10 @TomFitton          11
#&gt; # ‚Ñπ 564 more rows
```

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
